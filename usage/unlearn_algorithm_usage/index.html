<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>How to use existing unlearning algorithms - Unlearn Diff</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "How to use existing unlearning algorithms";
        var mkdocs_page_input_path = "usage/unlearn_algorithm_usage.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Unlearn Diff
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Usage</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">How to use existing unlearning algorithms</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../how_to_evaluate/">How to evaluate</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Unlearn Algorithms</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Concept Ablation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/concept_ablation/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/concept_ablation/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/concept_ablation/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Erase Diff</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/erase_diff/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/erase_diff/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/erase_diff/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >ESD</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/esd/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/esd/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/esd/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Forget Me Not</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/forget_me_not/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/forget_me_not/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/forget_me_not/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Saliency Unlearning</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/saliency/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/saliency/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/saliency/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Scissor Hands</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/scissorhands/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/scissorhands/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/scissorhands/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Selective Amnesia</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/selective_amnesia/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/selective_amnesia/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/selective_amnesia/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Semi Permeable Membrane</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/semipermeable_membrane/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/semipermeable_membrane/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/semipermeable_membrane/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Unified Concept Editing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/algorithms/uce/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/examples/uce/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/configs/uce/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Adv Unlearn</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/mu_defense/adv_unlearn/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../unlearn/mu_defense/config/">Config</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Evaluation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Non-Attack evalaution</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >No attack</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/attack/no_attack/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/configs/no_attack/">Config</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Robustness Eval UnlearnDiffAtk</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Hard Prompt</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/attack/hard_prompt/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/configs/hard_prompt/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Random</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/attack/random/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/configs/random/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Seed Search</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/attack/seed_search/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/configs/seed_search/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Text Grad</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/attack/text_grad/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../mu_attack/configs/text_grad/">Config</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Utility Eval</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Concept Ablation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/concept_ablation/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Erase Diff</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/erase_diff/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >ESD</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/esd/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Forget Me Not</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/forget_me_not/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Saliency Unlearning</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/saliency/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Scissor Hands</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/scissorhands/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Semi Permeable Membrane</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/semipermeable_membrane/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Unified Concept Editing</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/uce/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >MU_Defense</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/adv_unlearn_evaluation/">Usage</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Unlearn Diff</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Usage</li>
      <li class="breadcrumb-item active">How to use existing unlearning algorithms</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h3 id="run-train">Run Train <br></h3>
<p>Each algorithm has their own script to run the algorithm, Some also have different process all together. Follow usage section in readme for the algorithm you want to run with the help of the github repository. You will need to run the code snippet provided in usage section with necessary configuration passed. </p>
<p><strong>Example usage for erase_diff algorithm (CompVis model)</strong></p>
<p>The default configuration for training is provided by erase_diff_train_mu. You can run the training with the default settings as follows:</p>
<p><strong>Using the Default Configuration</strong></p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_mu

algorithm = EraseDiffAlgorithm(
    erase_diff_train_mu
)
algorithm.run()
</code></pre>
<p><br> <br></p>
<p><strong>Overriding the Default Configuration</strong></p>
<p>If you need to override the existing configuration settings, you can specify your custom parameters (such as ckpt_path and raw_dataset_dir) directly when initializing the algorithm. For example:</p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_mu

algorithm = EraseDiffAlgorithm(
    erase_diff_train_mu,
    ckpt_path=&quot;/home/ubuntu/Projects/UnlearnCanvas/UnlearnCanvas/machine_unlearning/models/compvis/style50/compvis.ckpt&quot;, #replace it with your ckpt path
    raw_dataset_dir=&quot;data/quick-canvas-dataset/sample&quot;,
    use_sample = True, #uses sample dataset
    template_name = &quot;Abstractionism&quot;,
    dataset_type = &quot;unlearncanvas&quot;,
    devices = &quot;0&quot;
)
algorithm.run()
</code></pre>
<p><span style="color: red;"><br>Note: When fine-tuning the model, if you want to use a sample dataset, set use_sample=True (default).Otherwise, set use_sample=False to use the full dataset.<br></span></p>
<p><strong>Machine unlearning with i2p dataset</strong></p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_i2p

algorithm = EraseDiffAlgorithm(
    erase_diff_train_i2p,
    ckpt_path=&quot;/home/ubuntu/Projects/UnlearnCanvas/UnlearnCanvas/machine_unlearning/models/compvis/style50/compvis.ckpt&quot;, #replace it with your ckpt path
    raw_dataset_dir=&quot;data/i2p-dataset/sample&quot;,
    num_samples = 1,
    dataset_type = &quot;i2p&quot;,
    template = &quot;i2p&quot;,
    template_name = &quot;self-harm&quot;,
    use_sample = True, #uses sample dataset
    devices = &quot;0&quot;

)
algorithm.run()
</code></pre>
<p><strong>Run on your won dataset</strong></p>
<p><strong>Step-1: Generate your own dataset</strong></p>
<pre><code class="language-bash">generate_images_for_prompts --model_path models/diffuser/style50 --csv_path data/prompts/generic_data.csv
</code></pre>
<p>Note:</p>
<ul>
<li>
<p>generate_images_for_prompts: This command invokes the image generation script. It uses a diffusion model to generate images based on textual prompts.</p>
</li>
<li>
<p>--model_path: Specifies the path to the diffusion model to be used for image generation. In this example, the model is located at models/diffuser/style50.</p>
</li>
<li>
<p>--csv_path: Provides the path to a CSV file containing the prompts. Each prompt in this CSV will be used to generate an image, allowing you to build a dataset tailored to your needs.</p>
</li>
</ul>
<p><strong>Step-2: Train on your own dataset</strong></p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_i2p

algorithm = EraseDiffAlgorithm(
    erase_diff_train_i2p,
    ckpt_path=&quot;/home/ubuntu/Projects/UnlearnCanvas/UnlearnCanvas/machine_unlearning/models/compvis/style50/compvis.ckpt&quot;, #replace it with your ckpt path
    raw_dataset_dir=&quot;data/generic_data&quot;,
    num_samples = 1,
    dataset_type = &quot;generic&quot;, #add the dataset type as generic
    template_name = &quot;self-harm&quot;, #concept to erase
    use_sample = True, #uses sample dataset
    devices = &quot;0&quot;

)
algorithm.run()
</code></pre>
<h3 id="add-your-own-unlearning-algorithms"><strong>Add your own unlearning algorithms:</strong></h3>
<p><strong>Contributing to Unlearn Diff</strong></p>
<p>Thank you for your interest in contributing to <strong>Unlearn</strong>! This document outlines the steps and best practices for adding new algorithms, making pull requests, filing issues, and more.</p>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#introduction">Introduction</a>  </li>
<li><a href="#code-of-conduct">Code of Conduct</a>  </li>
<li><a href="#project-structure">Project Structure</a>  </li>
<li><a href="#how-to-contribute">How to Contribute</a>  </li>
<li><a href="#reporting-issues">Reporting Issues</a>  </li>
<li><a href="#suggesting-enhancements">Suggesting Enhancements</a>  </li>
<li><a href="#submitting-pull-requests">Submitting Pull Requests</a>  </li>
<li><a href="#adding-a-new-algorithm">Adding a New Algorithm</a>  </li>
<li><a href="#folder-structure">Folder Structure</a>  </li>
<li><a href="#creating-an-environment">Creating an Environment</a>  </li>
<li><a href="#documentation">Documentation</a>  </li>
<li><a href="#code-style">Code Style</a>  </li>
<li><a href="#contact">Contact</a></li>
</ol>
<hr />
<p><strong>Introduction</strong></p>
<p><strong>Unlearn</strong> is an open-source Python package designed for unlearning algorithms in diffusion models. We welcome contributions from the community, whether it’s a new feature, bug fix, or an entirely new unlearning algorithm.</p>
<hr />
<h2 id="code-of-conduct">Code of Conduct</h2>
<p>Please note that we expect all contributors to abide by our code of conduct. Be respectful and considerate of others, and help keep our community healthy and inclusive.</p>
<hr />
<h2 id="project-architecture">Project Architecture</h2>
<p>The project is organized to facilitate scalability and maintainability.</p>
<ul>
<li><strong><code>data/</code></strong>: Stores data-related files.</li>
<li>
<p><strong><code>i2p-dataset/</code></strong>: contains i2p-dataset</p>
<ul>
<li><strong><code>sample/</code></strong>: Sample dataset</li>
<li><strong><code>full/</code></strong>: Full dataset</li>
</ul>
</li>
<li>
<p><strong><code>quick-canvas-dataset/</code></strong>: contains quick canvas dataset</p>
<ul>
<li><strong><code>sample/</code></strong>: Sample dataset</li>
<li><strong><code>full/</code></strong>: Full dataset</li>
</ul>
</li>
<li>
<p><strong><code>docs/</code></strong>: Documentation, including API references and user guides.</p>
</li>
<li>
<p><strong><code>outputs/</code></strong>: Outputs of the trained algorithms.</p>
</li>
<li>
<p><strong><code>examples/</code></strong>: Sample code and notebooks demonstrating usage.</p>
</li>
<li>
<p><strong><code>logs/</code></strong>: Log files for debugging and auditing.</p>
</li>
<li>
<p><strong><code>models/</code></strong>: Repository of lora_diffusion and stable_diffusion.</p>
</li>
<li>
<p><strong><code>evaluation/</code></strong>: Contains metrics for evalaution.</p>
</li>
<li><strong><code>core/</code></strong>:Foundational classes.<ul>
<li><strong><code>base_evaluator.py</code></strong>: Base class for evaluation.</li>
<li><strong><code>mu_defense_base_image_generator.py</code></strong>: Base class for image generation.</li>
</ul>
</li>
<li><strong><code>helpers/</code></strong>: Utility functions and helpers.<ul>
<li><strong><code>parser.py</code></strong>: Parse attack logs for evaluation.</li>
<li><strong><code>utils.py</code></strong>: Utility function.</li>
</ul>
</li>
<li>
<p><strong><code>metrics/</code></strong>: Contains metrics for evalaution.</p>
<ul>
<li><strong><code>accuracy.py</code></strong></li>
<li><strong><code>asr.py</code></strong></li>
<li><strong><code>clip.py</code></strong></li>
<li><strong><code>fid.py</code></strong></li>
</ul>
</li>
<li>
<p><strong><code>mu/</code></strong>: Core source code.</p>
</li>
<li><strong><code>algorithms/</code></strong>: Implementation of various algorithms. Each algorithm has its own subdirectory containing code and a <code>README.md</code> with detailed documentation.<ul>
<li><strong><code>esd/</code></strong>: ESD algorithm components.</li>
<li><code>README.md</code>: Documentation specific to the ESD algorithm.</li>
<li><code>algorithm.py</code>: Core implementation of ESD.</li>
<li><code>configs/</code>: Configuration files for training and generation tasks.</li>
<li><code>constants/const.py</code>: Constant values used across the ESD algorithm.</li>
<li><code>environment.yaml</code>: Environment setup for ESD.</li>
<li><code>model.py</code>: Model architectures specific to ESD.</li>
<li><code>sampler.py</code>: Sampling methods used during training or inference.</li>
<li><code>scripts/train.py</code>: Training script for ESD.</li>
<li><code>evaluator.py</code>: Script that generates necessary outputs for evaluation.</li>
<li><code>trainer.py</code>: Training routines and optimization strategies.</li>
<li><code>utils.py</code>: Utility functions and helpers.</li>
<li><strong><code>ca/</code></strong>: Components for the CA algorithm.</li>
<li><code>README.md</code>: Documentation specific to the CA algorithm.</li>
<li><em>...and so on for other algorithms</em></li>
</ul>
</li>
<li><strong><code>core/</code></strong>: Foundational classes and utilities.<ul>
<li><code>base_algorithm.py</code>: Abstract base class for algorithm implementations.</li>
<li><code>base_data_handler.py</code>: Base class for data handling.</li>
<li><code>base_model.py</code>: Base class for model definitions.</li>
<li><code>base_sampler.py</code>: Base class for sampling methods.</li>
<li><code>base_trainer.py</code>: Base class for training routines.</li>
</ul>
</li>
<li><strong><code>datasets/</code></strong>: Dataset management and utilities.<ul>
<li><code>__init__.py</code>: Initializes the dataset package.</li>
<li><code>dataset.py</code>: Dataset classes and methods.</li>
<li><code>helpers/</code>: Helper functions for data processing.</li>
<li><code>unlearning_canvas_dataset.py</code>: Specific dataset class for unlearning tasks.</li>
</ul>
</li>
<li>
<p><strong><code>helpers/</code></strong>: Utility functions and helpers.</p>
<ul>
<li><code>helper.py</code>: General-purpose helper functions.</li>
<li><code>logger.py</code>: Logging utilities to standardize logging practices.</li>
<li><code>path_setup.py</code>: Path configurations and environment setup.</li>
</ul>
</li>
<li>
<p><strong><code>tests/</code></strong>: Test suites for ensuring code reliability.</p>
</li>
<li><strong><code>mu_attack/</code></strong>: Implementation of attack algorithms.</li>
<li><strong><code>attackers/</code></strong>: Contains different types of attackers.</li>
<li><strong><code>configs/</code></strong>: Configurations file.<ul>
<li><strong><code>illegal/</code></strong>: config for illegal task.</li>
<li><strong><code>nudity/</code></strong>: config for nudity task.</li>
<li><strong><code>object/</code></strong>: config for object task.</li>
<li><strong><code>style/</code></strong>: config for style task.</li>
<li><strong><code>violence/</code></strong>: config for violence task.</li>
</ul>
</li>
<li><strong><code>core/</code></strong>: Foundational classes.</li>
<li><strong><code>datasets/</code></strong>: script to generate dataset.</li>
<li><strong><code>exces/</code></strong>: Script to run attack</li>
<li><strong><code>tasks/</code></strong>: Implementation of tasks</li>
<li>
<p><strong><code>helpers/</code></strong>: Utility functions</p>
</li>
<li>
<p><strong><code>mu_defense/</code></strong>: Implementation of Advunlearn algorithms.</p>
</li>
<li><strong><code>algorithms/</code></strong>: Implementation of various defense algorithms. Each algorithm has its own subdirectory containing code and a <code>README.md</code> with detailed documentation.<ul>
<li><strong><code>adv_unlearn/</code></strong>: Adversial Unlearn algorithm components.</li>
<li><code>README.md</code>: Documentation specific to the advunlearn algorithm.</li>
<li><code>algorithm.py</code>: Core implementation of advunlearn.</li>
<li><code>configs/</code>: Configuration files for training and generation tasks.</li>
<li><code>model.py</code>: Model architectures specific to advunlearn.</li>
<li><code>image_generator.py</code>: Image generator methods for generating sample images for evaluation.</li>
<li><code>evaluator.py</code>: Script that generates necessary outputs for evaluation.</li>
<li><code>dataset_handler.py</code>: Dataset handler for advunlearn algorithm. </li>
<li><code>compvis_trainer.py</code>: training loop for CompVis models.</li>
<li><code>diffuser_trainer.py</code>: training loop for diffuser models.</li>
<li><code>trainer.py</code>: Trainer class orchestrates the adversarial unlearning training process.</li>
<li><code>utils.py</code>: Utility functions and helpers.</li>
</ul>
</li>
<li><strong><code>scripts.py</code></strong>: Commands to generate datasets and download models.</li>
<li><strong><code>notebooks/</code></strong>: Contains example implementation.</li>
<li><strong><code>tests/</code></strong>: Contains pytests.</li>
</ul>
<hr />
<h2 id="how-to-contribute">How to Contribute</h2>
<h3 id="reporting-issues">Reporting Issues</h3>
<ol>
<li>Check the to see if your bug or feature request has already been reported.  </li>
<li>If not, open a new issue. Provide a clear title and description, including steps to reproduce if it’s a bug.  </li>
<li>Label your issue appropriately (e.g., “bug”, “enhancement”, “documentation”).</li>
</ol>
<h3 id="suggesting-enhancements">Suggesting Enhancements</h3>
<ul>
<li>If you have an idea for a new feature or improvement, open a GitHub issue labeled “enhancement” or “feature request.”  </li>
<li>Include any relevant use-cases, examples, or background information to help the community understand your proposal.</li>
</ul>
<h3 id="submitting-pull-requests">Submitting Pull Requests</h3>
<ol>
<li><strong>Fork</strong> the repository and create your feature branch from <code>main</code> (or the appropriate branch if instructed otherwise):<br />
<code>bash
   git checkout -b feature/my-awesome-feature</code></li>
<li>Make your changes, including tests if applicable.  </li>
<li>Commit and push your changes:<br />
<code>bash
   git push origin feature/my-awesome-feature</code></li>
<li>Open a <strong>Pull Request</strong> from your fork into the main repo. Provide a clear description of what your PR does, referencing any related issues.</li>
</ol>
<p>Please ensure your PR follows the <a href="#code-style">Code Style</a> guidelines and includes updated or new tests if needed.</p>
<hr />
<h4 id="adding-a-new-algorithm">Adding a New Algorithm</h4>
<p>One of the core goals of <strong>Unlearn Diff</strong> is to make it easy to add and benchmark new unlearning algorithms. Follow these steps when introducing a new method.</p>
<h4 id="folder-structure">Folder Structure</h4>
<ol>
<li><strong>Create a new subfolder</strong> in <code>mu/algorithms/</code> with a clear, descriptive name (e.g., <code>my_new_algo</code>).  </li>
<li>
<p>Inside this subfolder, include the following (at minimum):</p>
<ul>
<li><code>algorithm.py</code>  </li>
<li><code>trainer.py</code>  </li>
<li><code>scripts/train.py</code> (and optionally <code>scripts/evaluate.py</code> if your training and evaluation are separate)  </li>
<li><code>configs/</code> containing YAML config files for training, evaluation, etc.  </li>
<li><code>environment.yaml</code> specifying dependencies for <code>conda</code>  </li>
<li><code>Readme.md</code> explaining how to install, run, and configure your new algorithm  </li>
<li>(Optional) <code>data_handler.py</code>, <code>datasets/</code>, <code>model.py</code>, <code>sampler.py</code>, <code>utils.py</code>, etc., depending on your algorithm’s design.</li>
</ul>
</li>
<li>
<p><strong>Extend or import</strong> from base classes in <code>mu/core/</code> if your algorithm logic aligns with any existing abstract classes (e.g., <code>BaseAlgorithm</code>, <code>BaseTrainer</code>, etc.). This ensures code consistency and easier maintenance.</p>
</li>
</ol>
<h4 id="adding-a-new-attack">Adding a New Attack</h4>
<p>To add a new attack method, follow these guidelines:</p>
<ol>
<li>
<p><strong>Folder Structure</strong>:</p>
<ul>
<li>Create a new file or subfolder under <code>mu_attack/attackers/</code> with a clear, descriptive name (e.g., <code>my_new_attack.py</code> or <code>mu_attack/attackers/my_new_attack/</code>).</li>
<li>If creating a subfolder, include essential files specific to attack implementation:<ul>
<li><strong>Attacks</strong>: The main implementation file for the attack logic (e.g., <code>attack.py</code>).</li>
<li><strong>Execs</strong>: Scripts or modules that execute the attack routines.</li>
<li><strong>Tasks</strong>: Task definitions for integrating and testing the attack.</li>
<li>Any helper modules or configuration files specific to your attack.</li>
</ul>
</li>
<li>Update or add corresponding YAML configuration files and config class under <code>mu_attack/configs/</code> if your attack requires custom settings.</li>
</ul>
</li>
<li>
<p><strong>Implementation</strong>:</p>
<ul>
<li>Extend or import from the base class <code>BaseAttacker</code> (located in <code>mu_attack/core/base_attacker.py</code>) if applicable.</li>
<li>Ensure that your attack method adheres to the input-output standards defined by the project.</li>
</ul>
</li>
<li>
<p><strong>Documentation &amp; Testing</strong>:</p>
<ul>
<li>Add detailed documentation within your new attack module and update the main documentation if needed.</li>
<li>Include tests covering your new attack method under the appropriate test directories.</li>
</ul>
</li>
<li>
<p><strong>Environment</strong>:</p>
<ul>
<li>If your attack method has unique dependencies, update the <code>environment.yaml</code> file within the relevant directory or provide instructions in your documentation on how to create a dedicated environment. Also update the common environment file that is located in the project's root directory.</li>
</ul>
</li>
</ol>
<h4 id="adding-a-new-defense">Adding a New Defense</h4>
<p>To integrate a new defense mechanism, please follow these steps:</p>
<ol>
<li>
<p><strong>Folder Structure</strong>:</p>
<ul>
<li>Create a new subfolder under <code>mu_defense/algorithms/</code> with a descriptive name (e.g., <code>my_new_defense</code>).</li>
<li>Within this subfolder, include essential files such as:</li>
<li><code>algorithm.py</code>: Contains the core logic of your defense method.</li>
<li><code>trainer.py</code>: Contains training routines and optimization strategies.</li>
<li><code>configs/</code>: Include configuration class for training and evaluation.</li>
<li><code>environment.yaml</code>: Specify dependencies unique to your defense method.</li>
<li><code>Readme.md</code>: Document usage instructions, configuration details, and any other relevant information.</li>
</ul>
</li>
<li>
<p><strong>Implementation</strong>:</p>
<ul>
<li>Extend or use base classes provided in <code>mu_defense/algorithms/core/</code> (e.g., <code>base_algorithm.py</code>, <code>base_trainer.py</code>) to ensure consistency with existing methods.</li>
<li>Implement any unique evaluation metrics or procedures if your defense requires them.</li>
</ul>
</li>
<li>
<p><strong>Documentation &amp; Testing</strong>:</p>
<ul>
<li>Document your defense method thoroughly within its <code>Readme.md</code> and update the global documentation if necessary.</li>
<li>Provide tests for your defense implementation to ensure its reliability and compatibility with the rest of the system.</li>
</ul>
</li>
<li>
<p><strong>Environment</strong>:</p>
<ul>
<li>If your defense algorithm has specific dependencies, use the provided <code>environment.yaml</code> file as a template and adjust it accordingly. Include clear instructions for users to create and activate the environment. Also update the common environment file that is located in the project's root directory.</li>
</ul>
</li>
</ol>
<h4 id="creating-an-environment">Creating an Environment</h4>
<p>The default environment file is located in the project root directory (<code>requirements.txt</code>). Contributors should update this file as needed to include any new packages required by their contributions making sure it doesnot effect other algorthms. If your module or algorithm requires unique dependencies, you may add a dedicated environment file in its respective directory, but be sure to update and maintain the default environment in the root.</p>
<p>Optionally, to keep dependencies organized, each algorithm has its own <code>environment.yaml</code>. Contributors are encouraged to:</p>
<ul>
<li>Specify all required packages (e.g., <code>torch</code>, <code>torchvision</code>, <code>diffusers</code>, etc.). </li>
<li>Name the environment after the algorithm, e.g., <code>mu_&lt;algorithm_name&gt;</code>.  </li>
<li>Update instructions in your algorithm’s <code>Readme.md</code> on how to install and activate this environment.</li>
<li>Ensure you run the pytests in the tests/ directory after adding a new algorithm to verify that the updated environment remains compatible with existing algorithms.</li>
</ul>
<h3 id="run-pytests">Run pytests</h3>
<p>Before integrating new algorithms into the repository, please run the existing tests using the modified environment file to ensure that your changes do not break any functionality.</p>
<p><strong>Steps to Run the Tests</strong></p>
<ol>
<li>
<p>Prepare the Environment Configuration:
    Make sure the environment is set up using the provided tests/test_config.yaml file. This file contains configuration settings for various components of the project, such as data directories, model paths, and algorithm-specific parameters. It includes:</p>
<ul>
<li>
<p>common_config_unlearn_canvas_mu:
    Contains settings for the UnlearnCanvas dataset, including paths for the data directory, CompVis and Diffuser model checkpoints, template information, and dataset type.</p>
</li>
<li>
<p>common_config_i2p:
    Provides configuration for the i2p dataset with similar settings as above.</p>
</li>
<li>
<p>evaluator_config:
    Specifies the classifier checkpoint path and sample usage flag for evaluation.</p>
</li>
<li>
<p>Algorithm-Specific Configurations:
    Settings for various algorithms like concept_ablation, forget_me_not, saliency_unlearning, semipermeable, unified_concept_editing, selective_amnesia, and attack/defense configurations.</p>
</li>
</ul>
</li>
<li>
<p>Run the Tests:
    Execute the following commands from the root of your repository:</p>
</li>
</ol>
<pre><code class="language-bash">pytest tests/test_mu.py
pytest tests/test_mu_attack.py
pytest tests/test_mu_defense.py
</code></pre>
<p>These commands will run tests for:</p>
<ul>
<li>
<p>tests/test_mu.py: Core machine unlearning functionalities including evaluation.</p>
</li>
<li>
<p>tests/test_mu_attack.py: Attack-related functionalities including evaluation.</p>
</li>
<li>
<p>tests/test_mu_defense.py: Defense-related functionalities including evaluation.</p>
</li>
<li>
<p>Verify the Results:
Ensure that all tests pass without errors. If any test fails, fix the issues before adding new algorithms to maintain compatibility with the existing codebase.</p>
</li>
</ul>
<h3 id="documentation">Documentation</h3>
<ul>
<li>Each algorithm folder <strong>must</strong> contain a <code>Readme.md</code> that documents:</li>
<li>High-level description of the algorithm (goals, references to papers, etc.).</li>
<li>How to install any special dependencies (if not covered by <code>environment.yaml</code>).</li>
<li>How to run training and evaluation (with example commands).</li>
<li>Explanation of the config files in <code>configs/</code>.</li>
<li>
<p>Any unique parameters or hyperparameters.</p>
</li>
<li>
<p>If you introduce new metrics or logs, please outline them in your algorithm’s README and update any relevant docs in the main <code>docs/</code> folder as needed.</p>
</li>
<li>
<p>If you have incorporated code or drawn inspiration from external codebases, please ensure that you properly credit and cite the original work within each script.</p>
</li>
</ul>
<hr />
<h2 id="code-style">Code Style</h2>
<ul>
<li>We recommend following <a href="https://peps.python.org/pep-0008/">PEP 8</a> for Python code.  </li>
<li>Use descriptive variable names, docstrings, and type hints where possible.  </li>
<li>Keep functions and methods short and focused—avoid large, monolithic methods.  </li>
<li>Use Python’s built-in logging or the logging utilities in <code>helpers/logger.py</code> for consistent log outputs. Use wandb global wandb logger if required.  </li>
</ul>
<p>Additionally, we prefer:
- <strong>4 spaces</strong> for indentation (no tabs).
- Meaningful commit messages: “Fix dataset loader bug for large images” vs. “Fix stuff.”</p>
<hr />
<h2 id="contact">Contact</h2>
<p>If you have any questions, feel free to open an issue or reach out to us via email. We appreciate your contributions and look forward to collaborating with you on <strong>Unlearn Diff</strong>!</p>
<hr />
<p>Thank you again for your interest in contributing. We’re excited to see your ideas and improvements!  </p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../installation/" class="btn btn-neutral float-left" title="Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../how_to_evaluate/" class="btn btn-neutral float-right" title="How to evaluate">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../installation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../how_to_evaluate/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
