<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Unlearn Diff</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Unlearn Diff";
        var mkdocs_page_input_path = "README.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> Unlearn Diff
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="usage/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="usage/unlearn_algorithm_usage/">Usage of existing unlearn algorithms</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="usage/how_to_evaluate/">Evaluate existing unlearn algorithms</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Unlearn Algorithms</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Concept Ablation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/concept_ablation/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/concept_ablation/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/concept_ablation/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Erase Diff</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/erase_diff/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/erase_diff/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/erase_diff/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >ESD</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/esd/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/esd/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/esd/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Forget Me Not</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/forget_me_not/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/forget_me_not/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/forget_me_not/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Saliency Unlearning</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/saliency/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/saliency/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/saliency/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Scissor Hands</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/scissorhands/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/scissorhands/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/scissorhands/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Selective Amnesia</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/selective_amnesia/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/selective_amnesia/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/selective_amnesia/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Semi Permeable Membrane</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/semipermeable_membrane/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/semipermeable_membrane/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/semipermeable_membrane/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Unified Concept Editing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/algorithms/uce/">Usage of existing unlearn algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/examples/uce/">Examples</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/configs/uce/">Configs</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Adv Unlearn</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/mu_defense/adv_unlearn/">Usage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="unlearn/mu_defense/config/">Config</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Evaluation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Non-Attack evalaution</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >No attack</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/attack/no_attack/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/configs/no_attack/">Config</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Robustness Eval UnlearnDiffAtk</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Random</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/attack/random/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/configs/random/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Seed Search</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/attack/seed_search/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/configs/seed_search/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Soft Prompt</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/attack/soft_prompt/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="" href="mu_attack/configs/soft_prompt.md">Config</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >UnlearnDiffAtk</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Hard Prompt</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/attack/UnlearnDiffAttack/hard_prompt/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/configs/hard_prompt/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Text Grad</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/attack/UnlearnDiffAttack/text_grad/">Usage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="mu_attack/configs/text_grad/">Config</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Utility Eval</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Concept Ablation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/concept_ablation/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/concept_ablation/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Erase Diff</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/erase_diff/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/erase_diff/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >ESD</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/esd/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/esd/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Forget Me Not</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/forget_me_not/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/forget_me_not/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Saliency Unlearning</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/saliency/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/saliency/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Scissor Hands</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/scissorhands/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/scissorhands/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Semi Permeable Membrane</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/semipermeable_membrane/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/semipermeable_membrane/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Unified Concept Editing</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/uce/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/uce/">Config</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Adv Unlearn</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/adv_unlearn_evaluation/">Evaluate existing unlearn algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="evaluation/configs/adv_unlearn_evaluation/">Config</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Contributing</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="evaluation/contributing/">How to contribute?</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">Unlearn Diff</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Unlearn Diff</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="unlearn-diff">Unlearn Diff</h1>
<p>Unlearn Diff is an open-source Python package designed to streamline the development of unlearning algorithms and establish a standardized evaluation pipeline for diffusion models. It provides researchers and practitioners with tools to implement, evaluate, and extend unlearning algorithms effectively.</p>
<h3 id="documentation"><a href="https://ramailotech.github.io/msu_unlearningalgorithm/"><strong>Documentation</strong></a></h3>
<p>You can find the full documentation for this project at the url given below.
https://ramailotech.github.io/msu_unlearningalgorithm/</p>
<h2 id="features">Features</h2>
<ul>
<li>
<p><strong>Comprehensive Algorithm Support</strong>: Includes commonly used concept erasing and machine unlearning algorithms tailored for diffusion models. Each algorithm is encapsulated and standardized in terms of input-output formats.</p>
</li>
<li>
<p><strong>Automated Evaluation</strong>: Supports automatic evaluation on datasets like UnlearnCanvas or IP2P. Performs standard and adversarial evaluations, outputting metrics as detailed in UnlearnCanvas and UnlearnDiffAtk.</p>
</li>
<li>
<p><strong>Extensibility</strong>: Designed for easy integration of new unlearning algorithms, attack methods, defense mechanisms, and datasets with minimal modifications.</p>
</li>
</ul>
<h3 id="supported-algorithms">Supported Algorithms</h3>
<p>The initial version includes established methods benchmarked in UnlearnCanvas and defensive unlearning techniques:</p>
<ul>
<li><strong>CA</strong> (Concept Ablation)</li>
<li><strong>ED</strong> (Erase Diff)</li>
<li><strong>ESD</strong> (Efficient Substitution Distillation)</li>
<li><strong>FMN</strong> (Forget Me Not)</li>
<li><strong>SU</strong> (Saliency Unlearning)</li>
<li><strong>SH</strong> (ScissorHands)</li>
<li><strong>SA</strong> (Selective Amnesia)</li>
<li><strong>SPM</strong> (Semi Permeable Membrane)</li>
<li><strong>UCE</strong> (Unified Concept Editing)
For detailed information on each algorithm, please refer to the respective <code>README.md</code> files located inside <code>mu/algorithms</code>.</li>
</ul>
<h2 id="project-architecture">Project Architecture</h2>
<p>The project is organized to facilitate scalability and maintainability.</p>
<pre><code>.
├── data/
│   ├── i2p-dataset/
│   │   ├── sample/
│   │   └── full/
│   └── unlearn-canvas-dataset/ # Renamed for clarity
│       ├── sample/
│       └── full/
│
├── docs/                 # Documentation, API references, user guides
│
├── models/               # Pre-trained model weights (e.g., Stable Diffusion, LORAs)
│
├── notebooks/            # Example notebooks and experimental code (merges 'examples/')
│
├── outputs/              # All generated outputs (images, artifacts) from runs
│
├── scripts/              # Standalone utility scripts
│   ├── download_models.py
│   └── prepare_datasets.py
│
├── src/                  # Centralized source code for the entire application
│   │
│   ├── mu/         # Core unlearning logic (previously 'mu/')
│   │   ├── __init__.py
│   │   ├── algorithms/
│   │   │   ├── esd/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── algorithm.py      # Core ESD implementation
│   │   │   │   ├── configs/          # ESD-specific configs
│   │   │   │   ├── model.py          # ESD-specific model
│   │   │   │   ├── trainer.py        # ESD-specific trainer
│   │   │   │   └── utils.py          # ESD-specific utilities
│   │   │   └── ca/
│   │   │       └── ... # etc.
│   │   ├── core/               # Base classes shared across unlearning algorithms
│   │   │   ├── base_algorithm.py
│   │   │   ├── base_trainer.py
│   │   │   └── base_model.py
│   │   └── datasets/               # Data handling and loading modules
│   │       ├── __init__.py
│   │       ├── base_handler.py
│   │       └── unlearn_canvas.py
│   │
│   ├── attack/             # Attack logic (previously 'mu_attack/')
│   │   ├── __init__.py
│   │   ├── algorithms/         # Specific attack implementations (previously 'attackers/')
│   │   ├── configs/
│   │   │   ├── illegal/
│   │   │   └── ...
│   │   └── tasks/              # Attack tasks (nudity, violence, etc.)
│   │
│   ├── defense/            # Defense logic (previously 'mu_defense/')
│   │   ├── __init__.py
│   │   └── algorithms/
│   │       └── adv_unlearn/
│   │           ├── __init__.py
│   │           ├── algorithm.py
│   │           ├── configs/
│   │           ├── model.py
│   │           ├── trainer.py
│   │           └── image_generator.py
│   │
│   ├── evaluation/         # Centralized evaluation framework
│   │   ├── __init__.py
│   │   ├── evaluator.py      # Main evaluator runner script
│   │   ├── metrics/
│   │   │   ├── accuracy.py
│   │   │   ├── asr.py
│   │   │   ├── clip.py
│   │   │   └── fid.py
│   │   └── utils/              # Evaluation-specific utilities (e.g., log parsers)
│   │       └── parser.py
│   │
│   └── utils/                # Project-wide shared utilities
│       ├── __init__.py
│       ├── logger.py
│       └── path_setup.py
│
├── tests/                # All tests for the source code
│   ├── test_unlearning.py
│   ├── test_attack.py
│   └── test_evaluation.py
│
├── environment.yaml      # Project-wide environment dependencies
├── main.py               # Main entry point to run training, evaluation, etc.
└── README.md             # Project overview and setup instructions
</code></pre>
<h2 id="datasets">Datasets</h2>
<p>We use the Unlearn Canvas benchmark dataset, available <a href="https://huggingface.co/datasets/nebulaanish/quick-canvas-benchmark">here</a>. Currently, the algorithms are trained using 5 images belonging to the themes of <strong>Abstractionism</strong> and <strong>Architectures</strong>.</p>
<h2 id="usage">Usage</h2>
<p>This section contains the usage guide for the package.</p>
<h3 id="installation">Installation</h3>
<h4 id="prerequisities">Prerequisities</h4>
<p>Ensure <code>conda</code> is installed on your system. You can install Miniconda or Anaconda:</p>
<ul>
<li><strong>Miniconda</strong> (recommended): <a href="https://docs.conda.io/en/latest/miniconda.html">https://docs.conda.io/en/latest/miniconda.html</a></li>
<li><strong>Anaconda</strong>: <a href="https://www.anaconda.com/products/distribution">https://www.anaconda.com/products/distribution</a></li>
</ul>
<p>After installing <code>conda</code>, ensure it is available in your PATH by running. You may require to restart the terminal session:</p>
<p>Before installing the unlearn_diff package, follow these steps to set up your environment correctly. These instructions ensure compatibility with the required dependencies, including Python, PyTorch, and ONNX Runtime.</p>
<p><strong>Step-by-Step Setup:</strong></p>
<ol>
<li>Create a Conda Environment Create a new Conda environment named myenv with Python 3.8.5:</li>
</ol>
<pre><code class="language-bash">conda create -n myenv python=3.8.5
</code></pre>
<ol>
<li>Activate the Environment Activate the environment to work within it:</li>
</ol>
<pre><code class="language-bash">conda activate myenv
</code></pre>
<ol>
<li>Install Core Dependencies Install PyTorch, torchvision, CUDA Toolkit, and ONNX Runtime with specific versions:</li>
</ol>
<pre><code class="language-bash">conda install pytorch==1.11.0 torchvision==0.12.0 cudatoolkit=11.3 onnxruntime==1.16.3 -c pytorch -c conda-forge
</code></pre>
<ol>
<li>Install our unlearn_diff Package using pip:</li>
</ol>
<pre><code class="language-bash">pip install unlearn_diff
</code></pre>
<ol>
<li>Install Additional Git Dependencies:</li>
</ol>
<p>After installing unlearn_diff, install the following Git-based dependencies in the same Conda environment to ensure full functionality:</p>
<pre><code class="language-bash">pip install git+https://github.com/CompVis/taming-transformers.git@master git+https://github.com/openai/CLIP.git@main git+https://github.com/crowsonkb/k-diffusion.git git+https://github.com/cocodataset/panopticapi.git git+https://github.com/Phoveran/fastargs.git@main git+https://github.com/boomb0om/text2image-benchmark
</code></pre>
<h3 id="downloading-data-and-models">Downloading data and models.</h3>
<p>After you install the package, you can use the following commands to download.</p>
<ol>
<li>
<p><strong>Dataset</strong>:</p>
<ul>
<li><strong>i2p</strong>:<ul>
<li><strong>Sample</strong>:
  <code>download_data sample i2p</code></li>
<li><strong>Full</strong>:
  <code>download_data full i2p</code></li>
</ul>
</li>
<li><strong>unlearn_canvas</strong>:<ul>
<li><strong>Sample</strong>:
  <code>download_data sample unlearn_canvas</code></li>
<li><strong>Full</strong>:
  <code>download_data full unlearn_canvas</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Model</strong>:</p>
<ul>
<li><strong>compvis</strong>:
  <code>download_model compvis</code></li>
<li><strong>diffuser</strong>:
  <code>download_model diffuser</code></li>
</ul>
</li>
<li>
<p><strong>Download best.onnx model</strong></p>
</li>
</ol>
<p><code>download_best_onnx</code></p>
<h3 id="run-train">Run Train <br></h3>
<p>Each algorithm has their own script to run the algorithm, Some also have different process all together. Follow usage section in readme for the algorithm you want to run with the help of the github repository. You will need to run the code snippet provided in usage section with necessary configuration passed. </p>
<p><strong>Example usage for erase_diff algorithm (CompVis model)</strong></p>
<p>The default configuration for training is provided by erase_diff_train_mu. You can run the training with the default settings as follows:</p>
<p><strong>Using the Default Configuration</strong></p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_mu

algorithm = EraseDiffAlgorithm(
    erase_diff_train_mu
)
algorithm.run()
</code></pre>
<p><br> <br></p>
<p><strong>Overriding the Default Configuration</strong></p>
<p>If you need to override the existing configuration settings, you can specify your custom parameters (such as ckpt_path and raw_dataset_dir) directly when initializing the algorithm. For example:</p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_mu

algorithm = EraseDiffAlgorithm(
    erase_diff_train_mu,
    ckpt_path=&quot;/home/ubuntu/Projects/UnlearnCanvas/UnlearnCanvas/machine_unlearning/models/compvis/style50/compvis.ckpt&quot;, #replace it with your ckpt path
    raw_dataset_dir=&quot;data/quick-canvas-dataset/sample&quot;,
    use_sample = True, #uses sample dataset
    template_name = &quot;Abstractionism&quot;,
    dataset_type = &quot;unlearncanvas&quot;,
    devices = &quot;0&quot;
)
algorithm.run()
</code></pre>
<p><span style="color: red;"><br>Note: When fine-tuning the model, if you want to use a sample dataset, set use_sample=True (default).Otherwise, set use_sample=False to use the full dataset.<br></span></p>
<p><strong>Machine unlearning with i2p dataset</strong></p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_i2p

algorithm = EraseDiffAlgorithm(
    erase_diff_train_i2p,
    ckpt_path=&quot;/home/ubuntu/Projects/UnlearnCanvas/UnlearnCanvas/machine_unlearning/models/compvis/style50/compvis.ckpt&quot;, #replace it with your ckpt path
    raw_dataset_dir=&quot;data/i2p-dataset/sample&quot;,
    num_samples = 1,
    dataset_type = &quot;i2p&quot;,
    template = &quot;i2p&quot;,
    template_name = &quot;self-harm&quot;,
    use_sample = True, #uses sample dataset
    devices = &quot;0&quot;

)
algorithm.run()
</code></pre>
<p><strong>Run on your own dataset</strong></p>
<p><strong>Step-1: Generate your own dataset</strong></p>
<pre><code class="language-bash">generate_images_for_prompts --model_path models/diffuser/style50 --csv_path data/prompts/generic_data.csv
</code></pre>
<p>Note:</p>
<ul>
<li>
<p>generate_images_for_prompts: This command invokes the image generation script. It uses a diffusion model to generate images based on textual prompts.</p>
</li>
<li>
<p>--model_path: Specifies the path to the diffusion model to be used for image generation. In this example, the model is located at models/diffuser/style50.</p>
</li>
<li>
<p>--csv_path: Provides the path to a CSV file containing the prompts. Each prompt in this CSV will be used to generate an image, allowing you to build a dataset tailored to your needs.</p>
</li>
</ul>
<p><strong>Step-2: Train on your own dataset</strong></p>
<pre><code class="language-python">from mu.algorithms.erase_diff.algorithm import EraseDiffAlgorithm
from mu.algorithms.erase_diff.configs import erase_diff_train_i2p

algorithm = EraseDiffAlgorithm(
    erase_diff_train_i2p,
    ckpt_path=&quot;/home/ubuntu/Projects/UnlearnCanvas/UnlearnCanvas/machine_unlearning/models/compvis/style50/compvis.ckpt&quot;, #replace it with your ckpt path
    raw_dataset_dir=&quot;data/generic_data&quot;,
    num_samples = 1,
    dataset_type = &quot;generic&quot;, #add the dataset type as generic
    template_name = &quot;self-harm&quot;, #concept to erase
    use_sample = True, #uses sample dataset
    devices = &quot;0&quot;

)
algorithm.run()
</code></pre>
<h3 id="evaluation">Evaluation:</h3>
<ol>
<li><strong>Evaluate using unlearn canvas dataset:</strong></li>
</ol>
<p>Note: Currently it supports evaluation for unlearn canvas dataset. I2p and generic dataset support needs to be added.</p>
<pre><code class="language-python">from mu.algorithms.erase_diff import EraseDiffEvaluator
from mu.algorithms.erase_diff.configs import (
    erase_diff_evaluation_config
)
from evaluation.metrics.accuracy import accuracy_score
from evaluation.metrics.clip import clip_score
from evaluation.metrics.fid import fid_score


evaluator = EraseDiffEvaluator(
    erase_diff_evaluation_config,
    ckpt_path=&quot;outputs/erase_diff/finetuned_models/erase_diff_self-harm_model.pth&quot;,
)
generated_images_path = evaluator.generate_images()

accuracy = accuracy_score(gen_image_dir=generated_images_path,
                          dataset_type = &quot;unlearncanvas&quot;,
                        classifier_ckpt_path = &quot;/home/ubuntu/Projects/models/classifier_ckpt_path/style50_cls.pth&quot;,
                          forget_theme=&quot;Bricks&quot;,
                          seed_list = [&quot;188&quot;] )
print(accuracy['acc'])
print(accuracy['loss'])

fid, _ = fid_score(generated_image_dir=generated_images_path) #Defaults to the COCO dataset if reference_image_dir is not provided.&quot;
print(fid)

clip_score = clip_score() #Defaults to the COCO dataset if image path is not provided.&quot;
print(clip_score)
</code></pre>
<p><strong>Link to our example usage notebooks</strong></p>
<ol>
<li><strong>Erase-diff (compvis model)</strong></li>
</ol>
<p>https://github.com/RamailoTech/msu_unlearningalgorithm/blob/main/notebooks/run_erase_diff.ipynb</p>
<ol>
<li><strong>forget-me-not (Diffuser model)</strong></li>
</ol>
<p>https://github.com/RamailoTech/msu_unlearningalgorithm/blob/main/notebooks/run_forget_me_not.ipynb</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!--
MkDocs version : 1.6.1
Build Date UTC : 2025-07-17 07:13:27.891197+00:00
-->
